<div id="node-7758823" class="node clear-block"> 
 <div class="meta"> 
 </div> 
 <div class="content"> 
  <h3>All submissions for this problem are available.</h3>
  <h3> Read problems statements in <a target="_blank" href="http://www.codechef.com/download/translated/MARCH15/mandarin/MTRWY.pdf">Mandarin Chinese </a> and <a target="_blank" href="http://www.codechef.com/download/translated/MARCH15/russian/MTRWY.pdf">Russian</a>.</h3> 
  <p>You have a rectangular grid of size <b>N × M</b>, namely, there are cells <b>(x, y)</b> for <b>1 ? x ? N, 1 ? y ? M</b>. Two cells are adjacent if they share a side. More formally, two cells <b>(x<sub>1</sub>, y<sub>1</sub>), (x<sub>2</sub>, y<sub>2</sub>)</b> are adjacent if <b>|x<sub>1</sub> ? x<sub>2</sub>| + |y<sub>1</sub> ? y<sub>2</sub>| = 1</b>. Between two adjacent cells there can be a wall. Two cells <b>a</b> and <b>b</b> are connected if there is a way between them (in other words there is a sequence of cells <b>c<sub>1</sub>, c<sub>2</sub>, ..., c<sub>k</sub></b> that <b>c<sub>1</sub> = a, c<sub>k</sub> = b</b>, and for each <b>1 ? i &lt; k</b>, <b>c<sub>i</sub>, c<sub>i+1</sub></b> are adjacent cells without wall between them).</p> 
  <p>Now you are given <b>Q</b> queries, each of whom is of following four types.</p> 
  <ul> 
   <li><b>1 x y</b> - build the wall between cells <b>(x, y)</b> and <b>(x, y+1)</b>. If there is already exist a wall between them, this query is ignored.</li> 
   <li><b>2 x y</b> - build the wall between cells <b>(x, y)</b> and <b>(x+1, y)</b>. If there is already exist a wall between them, this query is ignored.</li> 
   <li><b>3 x<sub>1</sub> y<sub>1</sub> x<sub>2</sub> y<sub>2</sub></b> - check if cells <b>(x<sub>1</sub>, y<sub>1</sub>)</b> and <b>(x<sub>2</sub>, y<sub>2</sub>)</b> are connected. You must answer <b>1</b> if they are connected, <b>0</b> otherwise.</li> 
   <li><b>4</b> - You must answer the size of the largest connected component. A connected component is a set of sells wherein each two cells are connected. The size of a connected component is a number of the cells in it.</li> 
  </ul> 
  <p>You must assume that there are no walls on the grid before the queries.</p> 
  <h3>Input</h3> 
  <p>The first line of input contains an integer <b>T</b>, denoting the number of test cases. Then <b>T</b> test cases are follow.</p> 
  <p>The first line of each test case contains three space-separated integers <b>N, M</b> and <b>Q</b>, denoting the grid sizes and amount of queries. For next <b>Q</b> lines, each line contains a query. The format of queries are the same as described by the statement.</p> 
  <h3>Output</h3> 
  <p>For each test case, output an integer, denoting the sum of answers for queries of type <b>3</b> and <b>4</b>. Note that you just print only the sum of the answers for each test case.</p> 
  <h3>Constraints and Subtasks</h3> 
  <ul> 
   <li><b>1 ? T ? 100</b></li> 
   <li><b>2 ? N, M ? 1000</b></li> 
   <li>The sum of <b>Q</b> over all test cases in one test file does not exceed <b>10<sup>6</sup></b></li> 
   <li>For queries of type <b>1</b>: <b>1 ? x ? N</b> and <b>1 ? y ? M?1</b></li> 
   <li>For queries of type <b>2</b>: <b>1 ? x ? N?1</b> and <b>1 ? y ? M</b></li> 
   <li>For queries of type <b>3</b>: <b>1 ? x<sub>1</sub>, x<sub>2</sub> ? N</b> and <b>1 ? y<sub>1</sub>, y<sub>2</sub> ? M</b></li> 
  </ul> 
  <p></p> 
  <p><b>Subtask 1: (15 points)</b></p> 
  <ul> 
   <li><b>1 ? Q × N × M ? 10<sup>6</sup></b></li> 
  </ul> 
  <p></p> 
  <p><b>Subtask 2: (15 points)</b></p> 
  <ul> 
   <li><b>1 ? N, M ? 300</b></li> 
   <li>The sum of <b>Q</b> over all test cases in one test file does not exceed <b>10<sup>5</sup></b></li> 
  </ul> 
  <p></p> 
  <p><b>Subtask 3: (70 points)</b></p> 
  <ul> 
   <li>No additional constraints</li> 
  </ul> 
  <h3>Example</h3> 
  <pre><b>Input:</b>
1
3 4 10
3 1 1 3 4
1 1 2
1 2 2
2 2 2
4
1 3 1
4
3 1 1 3 4
1 1 2
3 1 1 1 1

<b>Output:</b>
21
</pre>
  <h3>Explanation</h3> 
  <p><b>Query 1.</b> There are a lot of ways from <b>(1,1)</b> to <b>(3,4)</b>. One of them is marked in red in the picture #1. So these are connected, then <b>Answer = 1</b> in this query.</p> 
  <p><b>Query 2.</b> In the picture #2 you can see the grid after second query. </p> 
  <p><b>Query 3.</b> In the picture #3 you can see the grid after third query. </p> 
  <p><b>Query 4.</b> In the picture #4 you can see the grid after fourth query.</p> 
  <p><b>Query 5.</b> In the picture #5 the largest connected component marked in green. Thus <b>Answer = 12</b>.</p> 
  <p><b>Query 6.</b> In the picture #6 you can see the grid after sixth query.</p> 
  <p><b>Query 7.</b> In the picture #7 the largest connected component marked in green. Thus <b>Answer = 7</b>.</p> 
  <p><b>Query 8.</b> As you can see in the picture #8, there are no ways from <b>(1,1)</b> to <b>(3,4)</b>. So they are no longer connected, then <b>Answer = 0</b>.</p> 
  <p><b>Query 9.</b> In the picture #9 you can see the grid after ninth query. There is no difference between it and the grid after the sixth query, because before the ninth query the wall was already built.</p> 
  <p><b>Query 10.</b> When <b>a = b</b>, two cells <b>a</b> and <b>b</b> are always connected. Thus <b>Answer = 1</b>.</p> 
  <p>Therefore, the sum of the answers is <b>1 + 12 + 7 + 0 + 1 = 21</b>, which you should print.</p> 
  <p><img src="https://codechef_shared.s3.amazonaws.com/download/MARCH15/mtrwy.png" width="600" height="400" alt="explanation"> </p> 
 </div> 
 <hr> 
 <table cellspacing="0" cellpadding="0" align="left"> 
  <tbody>
   <tr> 
    <td width="14%">Author:</td> 
    <td><a href="/users/antoniuk1">antoniuk1</a></td> 
   </tr> 
   <tr> 
    <td width="14%">Tester:</td> 
    <td><a href="/users/laycurse">laycurse</a></td> 
   </tr> 
   <tr> 
    <td width="14%">Editorial</td> 
    <td><a href="http://discuss.codechef.com/problems/MTRWY">http://discuss.codechef.com/problems/MTRWY</a></td> 
   </tr> 
   <tr> 
    <td width="14%">Tags</td> 
    <td><a class="problem-tag-small " href="/tags/problems/antoniuk1"> antoniuk1 </a><a class="problem-tag-small " href="/tags/problems/easy"> easy </a><a class="problem-tag-small " href="/tags/problems/march15"> march15 </a><a class="problem-tag-small " href="/tags/problems/union-find"> union-find </a></td> 
   </tr> 
   <tr> 
    <td width="14%">Date Added:</td> 
    <td>29-01-2015</td> 
   </tr> 
   <tr> 
    <td width="14%">Time Limit:</td> 
    <td>5 sec</td> 
   </tr> 
   <tr> 
    <td width="14%">Source Limit:</td> 
    <td>50000 Bytes</td> 
   </tr> 
   <tr> 
    <td width="14%">Languages:</td> 
    <td>ADA, ASM, BASH, BF, C, C99 strict, CAML, CLOJ, CLPS, CPP 4.3.2, CPP 4.9.2, CPP14, CS2, D, ERL, FORT, FS, GO, HASK, ICK, ICON, JAVA, JS, LISP clisp, LISP sbcl, LUA, NEM, NICE, NODEJS, PAS fpc, PAS gpc, PERL, PERL6, PHP, PIKE, PRLG, PYPY, PYTH, PYTH 3.1.2, RUBY, SCALA, SCM chicken, SCM guile, SCM qobi, ST, TCL, TEXT, WSPC</td> 
   </tr> 
  </tbody>
 </table> 
 <p style="clear:left;"><br></p> 
 <ul class="button-list button-list-left"> 
  <li style="display:"><a href="/submit/MTRWY">Submit</a></li> 
 </ul> 
 <hr> 
 <h2 style="text-decoration: none;">Comments</h2> 
 <ul class="links inline">
  <li class="comment_forbidden first last"><span><i><strong>Please login at the top to post a comment.</strong></i><p></p></span></li> 
 </ul>
</div> 
<div id="comments"> 
 <a id="comment-99525"></a> 
 <div id="c99525" class="comment clear-block"> 
  <h3><a href="/problems/MTRWY#comment-99525" class="active">hello every one, can any one</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/islamdarwish">islamdarwish</a></strong>
   <span style="color:#828282"> @ 19 Mar 2015 09:51 AM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    hello every one, can any one help me by giving me a methodology or general guidelines to solve a problem. because i am very beginner and needs any hints to just start out.
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-99658"></a> 
 <div id="c99658" class="comment clear-block"> 
  <h3><a href="/problems/MTRWY#comment-99658" class="active">Getting SIGSEGV in the 3rd</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/s1g13">s1g13</a></strong>
   <span style="color:#828282"> @ 20 Mar 2015 09:37 AM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    Getting SIGSEGV in the 3rd subtask ???? Any suggestions... I have checked upon crossing of bounds...etc..
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-99692"></a> 
 <div id="c99692" class="comment clear-block"> 
  <h3><a href="/problems/MTRWY#comment-99692" class="active">@islamdarwish I think you</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/emarci15">emarci15</a></strong>
   <span style="color:#828282"> @ 20 Mar 2015 06:02 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    @islamdarwish I think you should start with some problems from the bottom of this page 
    <a href="http://www.codechef.com/problems/easy/" title="http://www.codechef.com/problems/easy/">http://www.codechef.com/problems/easy/</a> Then read this page: 
    <a href="http://www.quora.com/What-are-the-very-basic-algorithms-that-every-Computer-Science-student-must-be-aware-of" title="http://www.quora.com/What-are-the-very-basic-algorithms-that-every-Computer-Science-student-must-be-aware-of">http://www.quora.com/What-are-the-very-basic-algorithms-that-every-Compu...</a> , and learn the algorithms listed there.
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-99844"></a> 
 <div id="c99844" class="comment clear-block"> 
  <h3><a href="/problems/MTRWY#comment-99844" class="active">@s1g13 it may be that your</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/ad783">ad783</a></strong>
   <span style="color:#828282"> @ 24 Mar 2015 07:26 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    @s1g13 it may be that your recursive function calling is exceeding its limit of calling.Use iterative dfs algorithm then you wont get SIGSEGV.
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-100220"></a> 
 <div id="c100220" class="comment clear-block"> 
  <h3><a href="/problems/MTRWY#comment-100220" class="active">How to solve problems</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/s1x13">s1x13</a></strong>
   <span style="color:#828282"> @ 2 Apr 2015 12:42 AM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    How to solve problems involving ranges in general?
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-100234"></a> 
 <div id="c100234" class="comment clear-block"> 
  <h3><a href="/problems/MTRWY#comment-100234" class="active">How to create wall?</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/arijit_47">arijit_47</a></strong>
   <span style="color:#828282"> @ 2 Apr 2015 12:17 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    How to create wall?
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-100240"></a> 
 <div id="c100240" class="comment clear-block"> 
  <h3><a href="/problems/MTRWY#comment-100240" class="active">@emarci15 thanks too much for</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/islamdarwish">islamdarwish</a></strong>
   <span style="color:#828282"> @ 2 Apr 2015 03:58 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    @emarci15 thanks too much for help.
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-102878"></a> 
 <div id="c102878" class="comment clear-block"> 
  <h3><a href="/problems/MTRWY#comment-102878" class="active">pls helpp me i am new over</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/bishal_56">bishal_56</a></strong>
   <span style="color:#828282"> @ 2 May 2015 10:20 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    pls helpp me i am new over here
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-103069"></a> 
 <div id="c103069" class="comment clear-block"> 
  <h3><a href="/problems/MTRWY#comment-103069" class="active">Should we use maze solving</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/oiyio">oiyio</a></strong>
   <span style="color:#828282"> @ 7 May 2015 08:47 PM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    Should we use maze solving algorithm, or n-queens problem in order to solve this problem? I can't find how to solve it algorithmically?
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
 <a id="comment-103463"></a> 
 <div id="c103463" class="comment clear-block"> 
  <h3><a href="/problems/MTRWY#comment-103463" class="active">Do we have access to the test</a></h3> 
  <div class="submitted"> 
   <strong><a href="/users/hipp04">hipp04</a></strong>
   <span style="color:#828282"> @ 11 May 2015 12:39 AM</span> 
  </div> 
  <div class="content"> 
   <div class="comment-body">
    Do we have access to the test files used when running the submission?
   </div> 
   <div class="comment-moderation-links"></div> 
  </div> 
 </div> 
</div>